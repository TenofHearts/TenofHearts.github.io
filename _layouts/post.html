---
layout: base
---

{% include header.html type="post" %}

<style>
    .back-link {
        display: inline-block;
        margin-bottom: 30px;
        padding: 10px 20px;
        background: #f5f5f5;
        border-radius: 5px;
        text-decoration: none;
        color: #333;
        transition: background 0.3s;
    }

    .back-link:hover {
        background: #e0e0e0;
        text-decoration: none;
    }
</style>

<main class="{% if page.full-width %} container-fluid {% else %} container-md {% endif %}">
    <div class="row">
        <div class="{% if page.full-width %} col {% else %} col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 {% endif %}">

            {% if page.gh-repo %}
            {% assign gh_split = page.gh-repo | split:'/' %}
            {% assign gh_user = gh_split[0] %}
            {% assign gh_repo = gh_split[1] %}

            <div id="header-gh-btns">
                {% if page.gh-badge.size > 0 %}
                {% for badge in page.gh-badge %}
                {% case badge %}
                {% when 'star'%}
                <iframe
                    src="https://ghbtns.com/github-btn.html?user={{ gh_user }}&repo={{ gh_repo }}&type=star&count=true"
                    frameborder="0" scrolling="0" width="120px" height="20px"></iframe>
                {% when 'watch'%}
                <iframe
                    src="https://ghbtns.com/github-btn.html?user={{ gh_user }}&repo={{ gh_repo }}&type=watch&v=2&count=true"
                    frameborder="0" scrolling="0" width="120px" height="20px"></iframe>
                {% when 'fork'%}
                <iframe
                    src="https://ghbtns.com/github-btn.html?user={{ gh_user }}&repo={{ gh_repo }}&type=fork&count=true"
                    frameborder="0" scrolling="0" width="120px" height="20px"></iframe>
                {% when 'follow'%}
                <iframe src="https://ghbtns.com/github-btn.html?user={{ gh_user }}&type=follow&count=true"
                    frameborder="0" scrolling="0" width="220px" height="20px"></iframe>
                {% endcase %}
                {% endfor %}
                {% endif %}
            </div>
            {% endif %}

            {% if page.before-content %}
            <div class="before-content">
                {% for file in page.before-content %}
                {% include {{ file }} %}
                {% endfor %}
            </div>
            {% endif %}

            <div class="blog-post">
                {{ content }}
            </div>

            {% if page.tags.size > 0 %}
            <div class="blog-tags">
                <span>Tags:</span>
                {% for tag in page.tags %}
                <a href="{{ '/tags' | relative_url }}#{{- tag -}}">{{- tag -}}</a>
                {% endfor %}
            </div>
            {% endif %}

            {% if page.after-content %}
            <div class="after-content">
                {% for file in page.after-content %}
                {% include {{ file }} %}
                {% endfor %}
            </div>
            {% endif %}

            {% if page.social-share %}
            {% include social-share.html %}
            {% endif %}

            {% comment %}获取当前文章所属的category{% endcomment %}
            {% assign current_category = page.path | split: "/" | slice: 1, 1 | first %}
            {% assign category_url = '/category/' | append: current_category | downcase | append: '.html' | relative_url
            %}

            {% comment %}获取同一category下的所有文章并按日期排序{% endcomment %}
            {% assign category_posts = site.posts
            | where_exp: "post", "post.path contains current_category"
            | sort: "date" %}

            {% comment %}找到当前文章在category中的位置{% endcomment %}
            {% assign current_index = -1 %}
            {% for post in category_posts %}
            {% if post.url == page.url %}
            {% assign current_index = forloop.index0 %}
            {% break %}
            {% endif %}
            {% endfor %}

            {% comment %}获取同category下的上一篇和下一篇{% endcomment %}
            {% assign prev_index = current_index | minus: 1 %}
            {% assign next_index = current_index | plus: 1 %}
            {% if prev_index >= 0 %}
            {% assign prev_post = category_posts[prev_index] %}
            {% endif %}
            {% if next_index < category_posts.size %} {% assign next_post=category_posts[next_index] %} {% endif %} <p>
                <a class="back-link" href="{{ category_url }}">← 返回</a>
                </p>

                <ul class="pagination blog-pager">
                    {% if prev_post %}
                    <li class="page-item previous">
                        <a class="page-link" href="{{ prev_post.url | relative_url }}" data-toggle="tooltip"
                            data-placement="top" title="{{prev_post.title | strip_html | xml_escape}}">
                            <i class="fas fa-arrow-left" alt="Previous Post"></i>
                            <span class="d-none d-sm-inline-block">Previous Post</span>
                        </a>
                    </li>
                    {% endif %}
                    {% if next_post %}
                    <li class="page-item next">
                        <a class="page-link" href="{{ next_post.url | relative_url }}" data-toggle="tooltip"
                            data-placement="top" title="{{next_post.title | strip_html | xml_escape}}">
                            <span class="d-none d-sm-inline-block">Next Post</span>
                            <i class="fas fa-arrow-right" alt="Next Post"></i>
                        </a>
                    </li>
                    {% endif %}
                </ul>
                {% include comments.html %}
        </div>
    </div>
</main>